{"ast":null,"code":"import { db } from '../../lib/firebase';\nimport auth0 from '../../lib/auth0';\nimport getCurrentDate from '../../util/getCurrentDate';\nexport default async function (req, res) {\n  console.log(req.query); // const session = await auth0.getSession(req);\n  // // Verifica se o usuário está logado\n  // if (!session) {\n  //   return res.status(401).json({\n  //     props: {\n  //       isAuth: false,\n  //     },\n  //   });\n  // }\n  // /*\n  //  * Verifica se o usuário já cadastrou seu status diario\n  //  */\n  // const currentDate = getCurrentDate();\n  // const userDailyStatus = await db\n  //   .collection('users')\n  //   .doc(session.user.sub)\n  //   .collection('history')\n  //   .doc(currentDate)\n  //   .get();\n  // const todayRegistered = userDailyStatus.data();\n  // if (!todayRegistered) {\n  //   return res.json({\n  //     props: {\n  //       isAuth: true,\n  //       hasRegisteredDailyStatus: false,\n  //       user: session.user,\n  //     },\n  //   });\n  // }\n  // const filter = req.query;\n  // const coordinates = req.body;\n  // /* Caso o usuário já tenha cadastrado seu status diário, será verificado\n  //  * todos os usúarios que estao proximos dele\n  //  */\n  // const nearbyUsers = await db\n  //   .collection('history')\n  //   .doc('2020-04-20')\n  //   .collection('all')\n  //   .where('status', '==', filter)\n  //   .near({\n  //     center: coordinates,\n  //     radius: 10000,\n  //   })\n  //   .get();\n  // const nearbyUsersList = [];\n  // nearbyUsers.docs.forEach((doc) => {\n  //   nearbyUsersList.push({\n  //     id: doc.id,\n  //     status: doc.data().status,\n  //     coordinates: {\n  //       longitude: doc.data().coordinates.longitude,\n  //       latitude: doc.data().coordinates.latitude,\n  //     },\n  //   });\n  // });\n  // return res.status(200).json({\n  //   props: {\n  //     isAuth: true,\n  //     hasRegisteredDailyStatus: true,\n  //     user: session.user,\n  //     nearbyUsers: nearbyUsersList,\n  //   },\n  // });\n}","map":{"version":3,"sources":["/home/thiago/Documentos/Dev/Projetos/fullstack-lab/pages/api/nearby-users.js"],"names":["db","auth0","getCurrentDate","req","res","console","log","query"],"mappings":"AAAA,SAASA,EAAT,QAAmB,oBAAnB;AACA,OAAOC,KAAP,MAAkB,iBAAlB;AAEA,OAAOC,cAAP,MAA2B,2BAA3B;AAEA,eAAe,gBAAgBC,GAAhB,EAAqBC,GAArB,EAA0B;AACvCC,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACI,KAAhB,EADuC,CAEvC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD","sourcesContent":["import { db } from '../../lib/firebase';\nimport auth0 from '../../lib/auth0';\n\nimport getCurrentDate from '../../util/getCurrentDate';\n\nexport default async function (req, res) {\n  console.log(req.query);\n  // const session = await auth0.getSession(req);\n\n  // // Verifica se o usuário está logado\n  // if (!session) {\n  //   return res.status(401).json({\n  //     props: {\n  //       isAuth: false,\n  //     },\n  //   });\n  // }\n\n  // /*\n  //  * Verifica se o usuário já cadastrou seu status diario\n  //  */\n  // const currentDate = getCurrentDate();\n\n  // const userDailyStatus = await db\n  //   .collection('users')\n  //   .doc(session.user.sub)\n  //   .collection('history')\n  //   .doc(currentDate)\n  //   .get();\n\n  // const todayRegistered = userDailyStatus.data();\n  // if (!todayRegistered) {\n  //   return res.json({\n  //     props: {\n  //       isAuth: true,\n  //       hasRegisteredDailyStatus: false,\n  //       user: session.user,\n  //     },\n  //   });\n  // }\n\n  // const filter = req.query;\n  // const coordinates = req.body;\n\n  // /* Caso o usuário já tenha cadastrado seu status diário, será verificado\n  //  * todos os usúarios que estao proximos dele\n  //  */\n  // const nearbyUsers = await db\n  //   .collection('history')\n  //   .doc('2020-04-20')\n  //   .collection('all')\n  //   .where('status', '==', filter)\n  //   .near({\n  //     center: coordinates,\n  //     radius: 10000,\n  //   })\n  //   .get();\n\n  // const nearbyUsersList = [];\n\n  // nearbyUsers.docs.forEach((doc) => {\n  //   nearbyUsersList.push({\n  //     id: doc.id,\n  //     status: doc.data().status,\n  //     coordinates: {\n  //       longitude: doc.data().coordinates.longitude,\n  //       latitude: doc.data().coordinates.latitude,\n  //     },\n  //   });\n  // });\n\n  // return res.status(200).json({\n  //   props: {\n  //     isAuth: true,\n  //     hasRegisteredDailyStatus: true,\n  //     user: session.user,\n  //     nearbyUsers: nearbyUsersList,\n  //   },\n  // });\n}\n"]},"metadata":{},"sourceType":"module"}